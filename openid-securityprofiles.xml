<?xml version="1.0" encoding="UTF-8"?>

<rfc category="info" ipr="none" docName="openid-authentication-security-profiles-01.txt">

<?rfc toc="yes" ?>
<?rfc symrefs="yes" ?>
<?rfc sortrefs="yes"?>
<?rfc iprnotified="no" ?>
<?rfc strict="yes" ?>
<?rfc private="Draft" ?>

<!--
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>


-->

<front>
  <title abbrev='OpenID Authentication Security Profiles'>OpenID Authentication Security Profiles - Draft 1</title>
  <author initials='H.' surname="Granqvist" fullname='Hans Granqvist'>
    <organization>VeriSign, Inc.</organization>
    <address>
      <postal>
	<street>487 East Middlefield Rd.</street>
	<city>Mountain View</city>
	<region>CA</region>
	<code>94043</code>
	<country>US</country>
      </postal>
    </address>
  </author>
  <date month="September" year="2006"/>
  <abstract>
    <t>
      This memo defines security profiles for OpenID 2.0
      authentication protocol.  By agreeing on one or several such security
      profiles, an OpenID relying party and identity provider can decide the
      security properties for their mutual OpenID communication before such
      communication takes place.
    </t>
  </abstract>
</front>

<middle>

  <section title="Introduction">
    <t>
      The <xref target="OPENID">OpenID Authentication 2.0</xref> protocol 
      defines a way to prove ownership of an identifier. The typical use-case 
      of this protocol is to log into one or several web sites without having
      to deal with multiple usernames and passswords.
    </t>
    <t>
      In the protocol, claims of ownership to a specific identifier
      have several security dependencies, for example cryptographic
      primitives, trust in keying material, and reliance on underlying
      domain system. This memo seeks to describe a framework for mechisms to
      describe such dependencies, as well as defining a few usable profiles.
    </t>
    <t>
      This memo intentionally does not advise on usage of specific
      profiles, nor does it implicitly claim to cover all security
      dependencies of the protocol, nor does it decide how to process
      a party's willing or unwilling departure from a previously agreed-upon 
      profile.
    </t>
  </section>

  <section title="Requirements notation">
    <t>
      The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this 
      document are to be interpreted as described in <xref
      target="RFC2119">RFC 2119</xref>.
    </t>
  </section>

  <section anchor="defs" title="Definitions and Terminology">
    <t>TODO.</t>
  </section>

  <section anchor="goals" title="Goals">
    <t>
      This security profile specification has the following goals.

    <list style="numbers">
      <t>
	Define a framework for describing profiles that security mechanisms 
	with in <xref target="OPENID">OpenID Authentication 2.0</xref>.
      </t>
      <t>
	Define a number of security profiles using this framework.
      </t>
      <t>
	Absence or presence of these profiles MUST have no effect on the
	referenced OpenID protocol. Compliance (and non-compliance) should
	only be governed by the protocol's parties and not the protocol
	itself.
      </t>
      <t>
	The list of identified security variants must be extensible for
	future additions. This is necessary to handle security risks that
	were identified after this memo was written. 
      </t>
      <t>
	Any new security variants MUST be appended to the list of identified
	variants, and not override them. This is needed to keep previous
	defined profiles unchanged over time. A security variant that should
	no longer be used will be marked as such in the current version of
	this memo.
      </t>
    </list>
    </t>
  </section>

  <section anchor="non-goals" title="Non-goals">
    <t>
      This security profile specification has the following non-goals.
    <list style="numbers">
      <t>
	Automatic negotiation of profile. This memo intentionally does not 
	define a profile negotiation phase.
      </t>
      <t>
	Automatic detection of profile violations. Some security properties 
	are enforceable only via cooperation of the protocol parties. 
      </t>
    </list>
    </t>
  </section>

  <section anchor="reqs" title="Requirements">
    <t>TODO.</t>
  </section>

  <section anchor="conv" title="Conventions">
    <t>
      It is assumed an <xref target="OPENID">OpenID Authentication
      2.0</xref> party will advertise its intended profile compliance via
      the service discovery phase by using the service types defined in this
      memo.
    </t>
  </section>

  <section anchor="variants" title="Security variants">
    <t>
      The following section describes the identified security variants 
      in the <xref target="OPENID">OpenID Authentication 2.0</xref> protocol.
    </t>
    <texttable anchor="table_variants"> 
      <preamble>
	This table defines the security variants and the expected
	values. References are tp the OpenID specification.
      </preamble> 
      <ttcol align='left'>Number</ttcol> 
      <ttcol align='left'>Variant</ttcol> 
      <ttcol align='center'>Values</ttcol> 

      <c>1.</c>
      <c>
	Wildcards allowed in trust roots. This relates to whether the
	idp accepts wild carded trust roots as specified in section 8.2
      </c> 
      <c>
	One of Yes/No
      </c> 

      <c>2.</c>
      <c>
	Allow unsecure associations? Whether the idp agrees to
	process authentication messages with no assoc_handle in section 8.
      </c>
      <c>
	One of Yes/No
      </c>

      <c>3.</c>
      <c>
	Types of claimed identifiers accepted. Types of identifiers as
	enumerated in section 9.3.
      </c>
      <c>
	Set of Http/Https/XRI
      </c>
 
      <c>4.</c>
      <c>
	Self-issued certificates allowed for authentication. This
	Applies to all https traffic. If 'no' here, then idp *probably*
	requires all https identifiers to chain up to known trust roots, but
	that's intentionally not implied.
      </c>
      <c>
	One of Yes/No
      </c>

      <c>5.</c>
      <c>
	XRDS file must be signed. Signature on the XRDS as per XMLDSIG. Keying
	material not specified, since RP ultimately needs to make own decision
	whether to trust keys used for such signature.
      </c>
      <c>
	One of Yes/No
      </c>

      <c>6.</c>
      <c>
	XRDS must be retrieved over secure channel. This does not
	imply SSL. See note on 4. about trust roots.
      </c>
      <c>
	One of Yes/No
      </c>

      <c>7.</c>
      <c> 
	Accepted association session types. What types of session
	types can be used as defined in section 7.4.3
     </c>
     <c>
       Set of No-encryption/DH-SHA1/DH-SHA256
     </c>

      <c>8.</c>
      <c>
	RP must have XRDS. Should the relying party be required to
	advertise compliance with specific profiles as per section 11.
      </c>
      <c>
	One of Yes/No
      </c>
 
      <c>9.</c>
      <c>
	Accepted association types. What section 7.3. association
	types the IDP agrees to use for signatures.
      </c>
      <c>
	Set of HMAC-SHA1/HMAC-SHA256
      </c>

      <c>10.</c>
      <c>
	Association must be over secure channel. Whether the 7.4.1
	request must take place on a secure channel.
      </c>
      <c>
	One of Yes/No
      </c>
 
<!--
     <c>11.</c>
      <c>
	Allow IDP to select identifier. Whether the idp allows the
	identity to be set to http://openid.net/identifier_select/2.0
      </c>
      <c>
	One of Yes/No
      </c>
-->
      <postamble>
	Identified security variants.
      </postamble> 
    </texttable>
  </section>


  <section anchor="profiles" title="Profiles">
    <t>
      The following section specifies two profiles "A" and "B" as 
      examples. The identifier of these profiles are URLs that
      appends to http://openid.net/authn/2.0/.
    </t>
    <t>
      This memo uses names like "A" and "B" tather than"low 
      security" and "medium security" as such distinctions carry 
      implications and liabilities. There
      is also a risk of security creep that forces definitions to 
      change over time -- what is now 'medium security' could be 
      'low security' in a few years, and possibly 'useless security' 
      in yet another few years. But the definition will be stuck as
      'medium security' forever.
    </t>
    <section anchor="profile_a" title="Profile A">
      <t>
	The identifier for this profile is http://openid.net/authn/2.0/A
      </t>
      <texttable anchor="profile_a_variants"> 
	<preamble>
	  These are the profile settings as they relate 
	  to <xref target="profiles"/> .
	</preamble> 
	<ttcol align='left'>Number</ttcol> 
	<ttcol align='center'>Values</ttcol> 

	<c>1.</c>
	<c>Yes</c> 

	<c>2.</c>
	<c>Yes</c> 

	<c>3.</c>
	<c>Http/Https/XRI</c> 

	<c>4.</c>
	<c>Yes</c> 

	<c>5.</c>
	<c>No</c> 

	<c>6.</c>
	<c>No</c> 

	<c>7.</c>
	<c>DH-SHA1/DH-SHA256</c> 

	<c>8.</c>
	<c>No</c> 

	<c>9.</c>
	<c>HMAC-SHA1/HMAC-SHA256</c> 

	<c>10.</c>
	<c>No</c> 

<!--
	<c>11.</c>
	<c>Yes</c> 
-->
      </texttable>
    </section>



    <section anchor="profile_b" title="Profile B">
      <t>
	The identifier for this profile is http://openid.net/authn/2.0/B
      </t>
      <texttable anchor="profile_b_variants"> 
	<preamble>
	  These are the profile settings as they relate 
	  to <xref target="profiles"/>.
	</preamble> 
	<ttcol align='left'>Number</ttcol> 
	<ttcol align='center'>Values</ttcol> 

	<c>1.</c>
	<c>Yes</c> 

	<c>2.</c>
	<c>No</c> 

	<c>3.</c>
	<c>Http/Https/XRI</c> 

	<c>4.</c>
	<c>Yes</c> 

	<c>5.</c>
	<c>No</c> 

	<c>6.</c>
	<c>No</c> 

	<c>7.</c>
	<c>No-encryption</c> 

	<c>8.</c>
	<c>No</c> 

	<c>9.</c>
	<c>HMAC-SHA1/HMAC-SHA256</c> 

	<c>10.</c>
	<c>Yes</c> 

<!--
	<c>11.</c>
	<c>Yes</c> 
-->
      </texttable>
    </section>
  </section>

  <section title="Usage">
    <t>
      Intention to following one or several profiles defined in this memo or in
      other location can be advertised.
    </t>
    <t>
      Section 4.2. of the OpenID protocol defines the protocol discovery phase
      in which parties find out properties about each other. Adherence to
      one or several profiles should be advertised via this mechanism, including
      intendet expiry of such adherence.
    </t>
  </section>


  <section title="Security considerations">
    <t>
      TODO.
    </t>
  </section>

  <section title="IANA considerations">
    <t>
      This document has no actions for IANA.
    </t>
  </section>

</middle>


<back>
  <references title="Normative References">
    <reference anchor="OPENID" 
       target="http://openid.net/specs/openid-authentication-2_0-09.html">
      <front>
	<title>OpenID Authentication 2.0</title>
	<author initials="D." surname="Recordon" 
		fullname="David Recordon">
	  <organization>VeriSign</organization>
	</author>
	<author initials="J." surname="Hoyt" 
		fullname="Josh Hoyt">
	  <organization>JanRain</organization>
	</author>
	<author initials="D." surname="Hardt" 
		fullname="Dick Hardt">
	  <organization>Sxip</organization>
	</author>
	<author initials="B." surname="Fitzpatrick" 
		fullname="Brad Fitzpatrick">
	  <organization>Six Apart</organization>
	</author>
      </front>
    </reference>

    <reference anchor="RFC2119">
      <front>
	<title>Key words for use in RFCs to Indicate Requirement Levels</title>
	<author initials="S." surname="Bradner">
	  <organization>Harvard University</organization>
	</author>
	<date month="March" year="1997"/>
      </front>
      <seriesInfo name="RFC" value="2119"/>
    </reference>
  </references>
</back>

</rfc>
